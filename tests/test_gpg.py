import logging
import base64
from modelmapper.gpg import GPGMixin

PRIVATE_KEY = 'LS0tLS1CRUdJTiBQR1AgUFJJVkFURSBLRVkgQkxPQ0stLS0tLQpsUVBHQkY3cjcwOEJDQUM1bjZBZDFGdW51NkNjbU9VcjdiQjIxYVY1d2RhMjVhaUtKOUlaOENGc0k5dXpHT1hlCnh2TU9VMGE1WlN6Wkh6bWpuazFpaTlFYW9DeXhHZW5TcG1RdFIwSUJsSzhxbEJRdTI1Y0dzNVhENTdKdTZaNlQKVkJubTFLUGhWbXp2UTV5eTVTOElZa0tYM0hMd0xNRW91T051MUN6dXJ1ZDQyblRpZ3JNWFAxekxmTU9oQmtsdwo2VmdtNzhwQXdObFFRbDE1Mnp2RzhsUmlOS3FTUmpvakMrUFY3WTFoZ0NucXVETU5VZ01nbU95NkFFd3lWcS81CjBrM0JrZ0dUY1B4TU0xVFpaWHhCY3NXbm5ielc5bmZDKzV5WFJyUkp0M2tkbEZGWFdLVFc2ci9VOVZkblp0WlIKcUtXTDJ4ck9COUZKY3dPbTFiaElNZUVWYzd6ZDhyTjBVem01QUJFQkFBSCtCd01DdmphUHV6ZlR0WmJuaGJDVwpjUHZrdnBCQ1gvSXF5U2ptOXdudCtpSVVoQTcwdFArU1dNSThBRTJaTVFSQWVlek4yN3FkTkg2NEhKOEJ5eEx6CmdPSmd3elFDZld2UDBObjArUmdObTgrUWdWNVAyQmlQUmJhcGpzQ25VbGNaMmpwSlFzZTZBZE9GTEpCd05QM2gKdWVtRFhFSmtxZGRud1YvMldkdFBSQjNRbGpEU09qbWVWVG4rK05rR2dtU08zQjlUQmZGVXozN0xzb0JWRmM3dwpRY3JXQzJIRGgrYVlEMEpNdFNmWkc5S3hCU29IZUowQ0RIVjM2RkFqekN6VEFtcEFTWlNaR0RXVEpzRUZwQldRCjllQ1Y1TTFzTW5SZy84WGc0SGRNd2NWMm1NdWxBUWV0a0pZR3VGNTlLVElhT29kZGpscmlJMmhwdDMyL3FCdDMKMW5UYUZ4QVhubjk4VFBzTE5YaEdkTk1vRU1qRUhnZUNiS2FZdUhteUxyc25XeVUrdnFTZm9nbmgxRU5wd2lSQgpVNGRYMUZrQVpobE9FaFIvWEMzYjgwUWs5VU9BUjh6VW41Ulo0YlZlZUl3eXBCbE9GRUJ6OE1OaVJHdGxFcGhqCkdHcmp6ejJMN2k2OE1RTCs0MDZNUDlRT1UzV241dFR5M2djTjdpWitWbkZ4N0NKWGpETU52M1lyVWVUS0FIUWQKWXE4V3lZTzJMK3BibHdGTzZyWlFXc1E2aXN1VExHSmV3WHNHUzQvZnB6QUFuNzc0Zmx2RU5vUDhZNmI1ZXdOQgo2U0FzY1VnakdhSXpjVkxBZ1hweHlVZkMxYmhWeTVGZi9jbVhRT1MrLzBZOHFwK2JKNkVlS29xc3AxS3VncVJ3ClpCQWlIYk1acTAwWmxaYW9KOFdwOEJQMzFmdUFuUVUydjNmWGhKaHFOa1AzRGZzZXNLcEdkQmNtMjU1aTBxVnoKeDdZYm41RDhaT0dmd3UycUdKYXFBay93RGVaR0lDQ0RaVDN2ZXdpMG9jakRobkIrekRxR0lrR216ZGs3VVMxUApXWE5neU9pTG1XS0l5cndCejVFWlV1VllmZm1Bb2taRTA3Tm9nUTdEcVowL3JDbG9WUTFnUzhKVXZmYzR4S2RjClFKdzN1UHNOWCtOckFVdGNqSC9vdTFJQ1ExVTBZZXBKVmprb3Bua2h0Z3BEQUJTUktRcTRNMTloKzBpanhjNXQKSDhORVkydVdOZGRRdEN4QmRYUnZaMlZ1WlhKaGRHVmtJRXRsZVNBOGRHVnpkR2R3WjNWelpYSkFiWGxrYjIxaAphVzR1WTI5dFBva0JUZ1FUQVFnQU9CWWhCREEzS2w4b0pON2NHaHVjTjhTb1FFaDU1OGlnQlFKZTYrOVBBaHN2CkJRc0pDQWNDQmhVSUNRb0xBZ1FXQWdNQkFoNEJBaGVBQUFvSkVNU29RRWg1NThpZ2pLa0gvMThaRXo3eDNRYkcKRE1KS0FJbTkvb1N6UVl5R0RFZTBYS0JMVjJsS2w1SmVzQUZFZEJ3TTFKdlFpUGljQjFzR3Z6WW9mSTNwTnBMZAp2L29jNkZjNW5BODZrTHhXUnR3YnYzSlk1ODFoVndtWnZGa1h1NlBjMjlYZ042VXZTekFqMVFwazRray91YTRzClFyZllOZ2dwL2NBdGViaFN0dmxrZXpnUU5kMFk1dDF2dWxvYVUrM21tNndzWG5MczVIeVFqNk1BbnBWREtsSEgKc1d3Q3FWRWZ5aEtlbXZSRUFDL3FBOWlrZjRrMkljQzB5TWlzODdUWGhwMnpYdE85YitPQlZIRDRoc1BFdVArdwpKWkYyOEhmaFdWcUZXaVNla1VyYUtFL2Z1ZWdoZnpwdlhQckdiNGV4TTFkMnNkOWVZT0xBN0cxZEdWQ3BvUmtXCmZtQ3R1bXc3cldRPQo9eFVOZwotLS0tLUVORCBQR1AgUFJJVkFURSBLRVkgQkxPQ0stLS0tLQo='
PUBLIC_KEY = 'LS0tLS1CRUdJTiBQR1AgUFVCTElDIEtFWSBCTE9DSy0tLS0tCm1RRU5CRjdyNzA4QkNBQzVuNkFkMUZ1bnU2Q2NtT1VyN2JCMjFhVjV3ZGEyNWFpS0o5SVo4Q0ZzSTl1ekdPWGUKeHZNT1UwYTVaU3paSHptam5rMWlpOUVhb0N5eEdlblNwbVF0UjBJQmxLOHFsQlF1MjVjR3M1WEQ1N0p1Nlo2VApWQm5tMUtQaFZtenZRNXl5NVM4SVlrS1gzSEx3TE1Fb3VPTnUxQ3p1cnVkNDJuVGlnck1YUDF6TGZNT2hCa2x3CjZWZ203OHBBd05sUVFsMTUyenZHOGxSaU5LcVNSam9qQytQVjdZMWhnQ25xdURNTlVnTWdtT3k2QUV3eVZxLzUKMGszQmtnR1RjUHhNTTFUWlpYeEJjc1dubmJ6VzluZkMrNXlYUnJSSnQza2RsRkZYV0tUVzZyL1U5VmRuWnRaUgpxS1dMMnhyT0I5Rkpjd09tMWJoSU1lRVZjN3pkOHJOMFV6bTVBQkVCQUFHMExFRjFkRzluWlc1bGNtRjBaV1FnClMyVjVJRHgwWlhOMFozQm5kWE5sY2tCdGVXUnZiV0ZwYmk1amIyMCtpUUZPQkJNQkNBQTRGaUVFTURjcVh5Z2sKM3R3YUc1dzN4S2hBU0hubnlLQUZBbDdyNzA4Q0d5OEZDd2tJQndJR0ZRZ0pDZ3NDQkJZQ0F3RUNIZ0VDRjRBQQpDZ2tReEtoQVNIbm55S0NNcVFmL1h4a1RQdkhkQnNZTXdrb0FpYjMraExOQmpJWU1SN1Jjb0V0WGFVcVhrbDZ3CkFVUjBIQXpVbTlDSStKd0hXd2EvTmloOGplazJrdDIvK2h6b1Z6bWNEenFRdkZaRzNCdS9jbGpueldGWENabTgKV1JlN285emIxZUEzcFM5TE1DUFZDbVRpU1QrNXJpeEN0OWcyQ0NuOXdDMTV1RksyK1dSN09CQTEzUmptM1crNgpXaHBUN2VhYnJDeGVjdXprZkpDUG93Q2VsVU1xVWNleGJBS3BVUi9LRXA2YTlFUUFMK29EMktSL2lUWWh3TFRJCnlLenp0TmVHbmJOZTA3MXY0NEZVY1BpR3c4UzQvN0Fsa1hid2QrRlpXb1ZhSko2UlN0b29UOSs1NkNGL09tOWMKK3Nadmg3RXpWM2F4MzE1ZzRzRHNiVjBaVUttaEdSWitZSzI2YkR1dFpBPT0KPTg1Y0oKLS0tLS1FTkQgUEdQIFBVQkxJQyBLRVkgQkxPQ0stLS0tLQo='
PASSPHRASE = 'my passphrase'
RECEPIENT = 'testgpguser@mydomain.com'


class MyGPG(GPGMixin):
    GPG_PUBLIC_KEY = base64.b64decode(PUBLIC_KEY)
    GPG_PRIVATE_KEY = base64.b64decode(PRIVATE_KEY)
    GPG_RECIPIENT = RECEPIENT
    GPG_PASSPHRASE = PASSPHRASE

    logger = logging.getLogger(__name__)


class TestGPGMixin:

    def test_encrypt_and_decrypt_content(self):
        content = b"What is going on?"

        mygpg = MyGPG()
        encrypted = mygpg.gpg_encrypt_content(content)
        assert encrypted.startswith(b'-----BEGIN PGP MESSAGE-----')
        decrypted = mygpg.gpg_decrypt_content(encrypted)
        assert content == decrypted
